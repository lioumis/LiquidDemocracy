<div class="dashboard">
  <h2>Καλώς ορίσατε!</h2>

  <p-panel header="Ψηφοφορίες που μπορεί να σας ενδιαφέρουν">
    <p-carousel
      [value]="votings"
      [numVisible]="6"
      [numScroll]="6"
      [circular]="false"
      [responsiveOptions]="responsiveOptions"
      [showIndicators]="false"
      [showNavigators]="false">
      <ng-template let-voting pTemplate="item">
        <p-card class="voting-card">
          <div class="voting-content">
            <div class="voting-info">
              <h4 class="voting-title">{{ voting.name }}</h4>
              <p class="voting-topic">{{ voting.topic }}</p>
            </div>
            <div class="voting-stats">
              <div class="voting-icon">
                <i class="pi pi-check-square"></i> {{ voting.votes }}
              </div>
              <div class="voting-icon">
                <i class="pi pi-comments"></i> {{ voting.comments }}
              </div>
            </div>
            <p-button icon="pi pi-arrow-right" severity="secondary" class="voting-button" [outlined]="true"></p-button>
          </div>
        </p-card>
      </ng-template>
    </p-carousel>
  </p-panel>

  <div class="delegations">
    <p-panel header="Αναθέσεις Ψήφου">
      <p-table
        #dt
        [value]="delegations"
        dataKey="id"
        [rows]="5"
        [loading]="loading"
        [paginator]="true"
        [globalFilterFields]="['name', 'surname', 'topic']"
        [tableStyle]="{ 'min-width': '60rem' }">
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="name" style="width:33%">
              Όνομα
              <p-sortIcon field="name"/>
            </th>
            <th pSortableColumn="surname" style="width:33%">
              Επώνυμο
              <p-sortIcon field="surname"/>
            </th>
            <th pSortableColumn="topic" style="width:33%">
              Θέμα
              <p-sortIcon field="topic"/>
            </th>
          </tr>
          <tr>
            <th>
              <p-columnFilter
                [showMenu]="false"
                type="text"
                field="name"
                placeholder="Όνομα"
                ariaLabel="Filter Name"/>
            </th>
            <th>
              <p-columnFilter
                [showMenu]="false"
                type="text"
                field="surname"
                placeholder="Επώνυμο"
                ariaLabel="Filter Surname"/>
            </th>
            <th>
              <p-columnFilter field="topic" matchMode="in" [showMenu]="false">
                <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                  <p-multiSelect
                    [ngModel]="value"
                    [options]="topics"
                    placeholder="Θέμα"
                    (onChange)="filter($event.value)"
                    [maxSelectedLabels]=1
                    selectedItemsLabel="{0} θέματα επιλέχθηκαν"
                    optionLabel="">
                    <ng-template let-option pTemplate="item">
                      <div class="inline-block vertical-align-middle">
                        {{ option }}
                      </div>
                    </ng-template>
                  </p-multiSelect>
                </ng-template>
              </p-columnFilter>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-delegation>
          <tr>
            <td>
              {{ delegation.name }}
            </td>
            <td>
              {{ delegation.surname }}
            </td>
            <td>
              {{ delegation.topic }}
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="3">Δεν βρέθηκαν αναθέσεις ψήφου</td>
          </tr>
        </ng-template>
      </p-table>
    </p-panel>

    <p-panel header="Ψήφοι που σας έχουν ανατεθεί">
      <p-table
        #dt2
        [value]="receivedDelegations"
        dataKey="id"
        [style]="{'overflow':'visible'}"
        [rows]="5"
        sortField="votes" [sortOrder]="-1"
        [loading]="loading"
        [paginator]="true"
        [globalFilterFields]="['topic', 'votes']"
        [tableStyle]="{ 'min-width': '50rem' }">
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="topic" style="width:33%">
              Θέμα
              <p-sortIcon field="topic"/>
            </th>
            <th pSortableColumn="votes" style="width:33%">
              Αριθμός Ψήφων
              <p-sortIcon field="votes"/>
            </th>
          </tr>
          <tr>
            <th>
              <p-columnFilter field="topic" matchMode="in" [showMenu]="false">
                <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                  <p-multiSelect
                    [ngModel]="value"
                    [options]="topics"
                    placeholder="Θέμα"
                    (onChange)="filter($event.value)"
                    [maxSelectedLabels]=1
                    selectedItemsLabel="{0} θέματα επιλέχθηκαν"
                    optionLabel="">
                    <ng-template let-option pTemplate="item">
                      <div class="inline-block vertical-align-middle">
                        {{ option }}
                      </div>
                    </ng-template>
                  </p-multiSelect>
                </ng-template>
              </p-columnFilter>
            </th>
            <th>
              <p-columnFilter
                [showMenu]="false"
                type="numeric"
                field="votes"
                placeholder="Αριθμός"
                ariaLabel="Filter Votes"/>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-receivedDelegation>
          <tr>
            <td>
              {{ receivedDelegation.topic }}
            </td>
            <td>
              {{ receivedDelegation.votes }}
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="3">Δεν βρέθηκαν αναθέσεις ψήφου</td>
          </tr>
        </ng-template>
      </p-table>
    </p-panel>
  </div>
</div>
